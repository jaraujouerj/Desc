{{ define "main" }}
<style>
    .horario-container {
        margin-bottom: 40px;
    }
    .horario-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* 5 days: Seg-Sex */
        border: 1px solid #dee2e6;
        border-radius: .25rem;
        overflow: hidden;
    }
    .dia-coluna {
        border-left: 1px solid #dee2e6;
    }
    .dia-coluna:first-child {
        border-left: 0;
    }
    .dia-header {
        text-align: center;
        font-weight: bold;
        padding: .75rem;
        background-color: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
    }
    .horarios-do-dia {
        padding: 10px;
        min-height: 100px;
    }
    .disciplina-bloco {
        border: 1px solid rgba(0,0,0,0.05);
        border-radius: 5px;
        padding: 10px;
        margin-bottom: 10px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .disciplina-bloco p {
        margin: 0;
        font-size: 0.85em;
        color: #333;
    }
    .disciplina-bloco .disciplina-nome {
      font-weight: bold;
      font-size: 0.9em;
    }

    /* Responsive adjustments */
    @media (max-width: 992px) {
        .horario-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    @media (max-width: 768px) {
        .horario-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    @media (max-width: 576px) {
        .horario-grid {
            grid-template-columns: 1fr;
        }
    }

</style>

<h1>Horários das Turmas</h1>

{{ $colors := slice "#FFADAD" "#FFD6A5" "#FDFFB6" "#CAFFBF" "#9BF6FF" "#A0C4FF" "#BDB2FF" "#FFC6FF" "#E0E0E0" "#BDBDBD" "#A5D6A7" "#FFCC80" }}
{{ $colorMap := dict }}
{{ $disciplinasFeitas := dict }}
{{ $colorIndex := 0 }}

{{/* Create a map of disciplines to colors */}}
{{ range .Site.Data.pt.horarios.turmas }}
    {{ range .horarios }}
        {{ if not (isset $disciplinasFeitas .disciplina) }}
            {{ $disciplinasFeitas = merge $disciplinasFeitas (dict .disciplina true) }}
            {{ $colorMap = merge $colorMap (dict .disciplina (index $colors $colorIndex)) }}
            {{ $colorIndex = add $colorIndex 1 }}
            {{ if ge $colorIndex (len $colors) }}
                {{ $colorIndex = 0 }}
            {{ end }}
        {{ end }}
    {{ end }}
{{ end }}

{{ range .Site.Data.pt.horarios.turmas }}
<div class="horario-container">
    <h2>{{ .nome }}</h2>

    {{ $horariosPorDia := dict }}
    {{ $dias := slice "Seg" "Ter" "Qua" "Qui" "Sex" }}
    {{ range $dias }}
        {{ $horariosPorDia = merge $horariosPorDia (dict . (slice)) }}
    {{ end }}

    {{ range .horarios }}
        {{ if isset $horariosPorDia .dia }}
            {{ $lista := index $horariosPorDia .dia }}
            {{ $lista = $lista | append . }}
            {{ $horariosPorDia = merge $horariosPorDia (dict .dia $lista) }}
        {{ end }}
    {{ end }}

    <div class="horario-grid" role="table" aria-label="Horário para {{ .nome }}">
        {{ range $dias }}
            <div class="dia-coluna" role="rowgroup">
                <div class="dia-header" role="columnheader">{{ . }}</div>
                <div class="horarios-do-dia" role="gridcell">
                {{ $horariosDoDia := index $horariosPorDia . }}
                {{ if gt (len $horariosDoDia) 0 }}
                    {{ range sort $horariosDoDia "inicio" }}
                        <div class="disciplina-bloco" style="background-color: {{ index $colorMap .disciplina }};">
                            <p class="disciplina-nome">{{ .disciplina }}</p>
                            <p>{{ .inicio }} - {{ .fim }}</p>
                            <p>{{ .professor }}</p>
                            <p>Sala: {{ .sala }}</p>
                        </div>
                    {{ end }}
                {{ end }}
                </div>
            </div>
        {{ end }}
    </div>
</div>
{{ end }}
{{ end }}